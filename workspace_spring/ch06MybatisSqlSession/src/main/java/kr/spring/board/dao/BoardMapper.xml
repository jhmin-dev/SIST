<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="BoardDAO">
	<!-- 총 레코드 수 -->
	<select id="getBoardCount" resultType="integer"> <!-- java.lang.Integer의 alias가 integer -->
		SELECT
			COUNT(*)
		FROM tboard
	</select>

	<!-- 목록 -->
	<select id="getBoardList" resultType="boardVO" parameterType="map"> <!-- java.util.Map의 alias가 map -->
		SELECT
			*
		FROM (SELECT
				a.*, ROWNUM AS rnum
			FROM (
				SELECT 
					* 
				FROM tboard
				ORDER BY num DESC) a)
		<![CDATA[
		WHERE rnum >= #{start} AND rnum <= #{end}
		]]> <!-- <는 XML에서 태그를 시작하는 기호라 문법 검사시 에러가 발생하므로, CDATA를 이용하여 문법 검사를 건너뛰도록 처리; SQL문에 Map 객체의 데이터를 바인딩시, #{key} 형식으로 key의 값을 호출 -->
	</select>
	
	<!-- 글쓰기 -->
	<insert id="insertBoard" parameterType="boardVO">
		INSERT INTO tboard (
			num,
			name,
			title,
			passwd,
			content,
			reg_date)
		VALUES (
			tboard_seq.NEXTVAL,
			#{name}, <!-- SQL문에 자바빈 객체의 데이터를 바인딩시, #{프로퍼티명} 형식으로 프로퍼티의 값을 호출  -->
			#{title},
			#{passwd},
			#{content},
			SYSDATE)
	</insert>
	
	<!-- 글 상세 -->
	<select id="getBoard" resultType="boardVO" parameterType="integer">
		SELECT
			*
		FROM tboard
		WHERE num=#{num} <!-- SQL문에 자바빈/Map 객체가 아닌 데이터 하나만 바인딩시, #{변수명} 형식으로 값 호출 -->
	</select>
	
	<!-- 글 수정 -->
	<update id="updateBoard" parameterType="boardVO">
		UPDATE tboard
		SET
			name=#{name},
			title=#{title},
			content=#{content}
		WHERE num=#{num}
	</update>
	
	<!-- 글 삭제 -->
	<delete id="deleteBoard" parameterType="integer">
		DELETE FROM tboard
		WHERE num=#{num}
	</delete>
</mapper>